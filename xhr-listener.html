<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>API Examples</title>
    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/default.min.css">
    <!-- JavaScript -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
</head>
<body>
    <article>
        <h1><code>XMLHttpRequest</code> with <code>EventListener</code></h1>
        <p>One way of using an <code>XMLHttpRequest</code> is to add an <code>EventListener</code> which will fire when the <code>XMLHttpRequest</code> 'loads'. The basic structure of this is as below:
            <pre>
                <code>
                    // Function that will process the response from the API
                    var processResponse = function() {
                        var data = JSON.parse(this.response);
                        // Replace this code with code that
                        // does something with the response
                        console.log(data);
                    }

                    // Function to ensure parameters used in request are encoded correctly
                    var encodeParameters = function(params) {
                        // join all key value pairs and store in an array
                        var strArray = [];
                        for(var key in params) {
                            if(params.hasOwnProperty(key)) {
                                var paramString = encodeURIComponent(key) + &quot;=&quot; + encodeURIComponent(params[key]);
                                strArray.push(paramString);
                            }
                        }
                        // join everything in the array together
                        return strArray.join(&quot;&amp;&quot;);
                    }

                    // the parameters for the API request
                    var parameters = {
                        lat: 51.4816,
                        lng: 3.1791,
                    }

                    // construct the URL to call
                    var base_url = &apos;http://api.sunrise-sunset.org/json&apos;;
                    var query_url = base_url + &apos;?&apos; + encodeParameters(parameters);
                    console.log(query_url);

                    // create an XMLHttpRequest object, add a listener to
                    // tell it what to do if successful, tell it which URL
                    // to GET, and then make (&apos;send&apos;) the call
                    var xhttp = new XMLHttpRequest();
                    xhttp.addEventListener(&apos;load&apos;, processResponse);
                    xhttp.open(&apos;GET&apos;, query_url);
                    xhttp.send();
                </code>
            </pre>
        </p>
    </article>
    <script>
         hljs.initHighlightingOnLoad();
    </script>
</body>
</html>
