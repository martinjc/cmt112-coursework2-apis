<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Spotify API Example</title>

        <!-- Styles -->
        <link rel="stylesheet" href="../../css/style.css">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/default.min.css">
        <!-- JavaScript -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
    </head>
    <body>
        <article>
            <h1>Spotify API Example</h1>
            <p>Accessing the Spotify Web API for retrieving public information is actually extremely simple. For a basic level of access (that may be rate limited) you do not even need to supply an API key. The endpoints you can use are listed in the API documentation <a href="https://developer.spotify.com/web-api/endpoint-reference/">here</a>. For example, to search for artists with a particular name and print the results to the console:
                <pre>
                    <code>
                        // Function that will process the response from the API
                        var processResponse = function() {
                            var data = JSON.parse(this.response);
                            // Replace this code with code that
                            // does something with the response
                            console.log(data);
                        }

                        // Function to ensure parameters used in request are encoded correctly
                        var encodeParameters = function(params) {
                            // join all key value pairs and store in an array
                            var strArray = [];
                            for(var key in params) {
                                if(params.hasOwnProperty(key)) {
                                    var paramString = encodeURIComponent(key) + &quot;=&quot; + encodeURIComponent(params[key]);
                                    strArray.push(paramString);
                                }
                            }
                            // join everything in the array together
                            return strArray.join(&quot;&amp;&quot;);
                        }

                        // the parameters for the API request
                        var parameters = {
                            q: &quot;Public Service Broadcasting&quot;,
                            type: &quot;artist&quot;
                        }

                        // construct the URL to call
                        var base_url = &apos;https://api.spotify.com/v1/search&apos;;
                        var query_url = base_url + &apos;?&apos; + encodeParameters(parameters);
                        console.log(query_url);

                        // create an XMLHttpRequest object, add a listener to
                        // tell it what to do if successful, tell it which URL
                        // to GET, and then make (&apos;send&apos;) the call
                        var xhttp = new XMLHttpRequest();
                        xhttp.addEventListener(&apos;load&apos;, processResponse);
                        xhttp.open(&apos;GET&apos;, query_url);
                        xhttp.send();
                    </code>
                </pre>
            </p>
            <p>You can retrieve lots more information about an artist. For instance, once we know the Spotify ID (by extracting it from the search response above perhaps), we can retrieve all the artist's albums that are available in Great Britain:
                <pre>
                    <code>
                        // Function that will process the response from the API
                        var processResponse = function() {
                            var data = JSON.parse(this.response);
                            // Replace this code with code that
                            // does something with the response
                            console.log(data);
                        }

                        // Function to ensure parameters used in request are encoded correctly
                        var encodeParameters = function(params) {
                            // join all key value pairs and store in an array
                            var strArray = [];
                            for(var key in params) {
                                if(params.hasOwnProperty(key)) {
                                    var paramString = encodeURIComponent(key) + &quot;=&quot; + encodeURIComponent(params[key]);
                                    strArray.push(paramString);
                                }
                            }
                            // join everything in the array together
                            return strArray.join(&quot;&amp;&quot;);
                        }

                        // the parameters for the API request
                        var parameters = {
                            market: &quot;GB&quot;,
                        }
                        var artist_id = &quot;6VsiDFMZJlJ053P1uO4A6h&quot;;

                        // construct the URL to call
                        var base_url = &apos;https://api.spotify.com/v1/artists/&apos; + artist_id + &apos;/albums&apos;;
                        var query_url = base_url + &apos;?&apos; + encodeParameters(parameters);
                        console.log(query_url);

                        // create an XMLHttpRequest object, add a listener to
                        // tell it what to do if successful, tell it which URL
                        // to GET, and then make (&apos;send&apos;) the call
                        var xhttp = new XMLHttpRequest();
                        xhttp.addEventListener(&apos;load&apos;, processResponse);
                        xhttp.open(&apos;GET&apos;, query_url);
                        xhttp.send();
                    </code>
                </pre>
            </p>
            <p><strong>IMPORTANT NOTE!</strong> This is <strong>NOT ENOUGH</strong> to pass Coursework 2 for CMT112 - you will need to add some extra functionality and presentation of data. I will not be impressed if your submission consists only of the code presented here!</p>
        </article>
    </body>
    <script>
        // Function that will process the response from the API
        var processResponse = function() {
            var data = JSON.parse(this.response);
            // Replace this code with code that
            // does something with the response
            console.log(data);
        }

        // Function to ensure parameters used in request are encoded correctly
        var encodeParameters = function(params) {
            // join all key value pairs and store in an array
            var strArray = [];
            for(var key in params) {
                if(params.hasOwnProperty(key)) {
                    var paramString = encodeURIComponent(key) + "=" + encodeURIComponent(params[key]);
                    strArray.push(paramString);
                }
            }
            // join everything in the array together
            return strArray.join("&");
        }

        // the parameters for the API request
        var parameters = {
            q: "Public Service Broadcasting",
            type: "artist"
        }

        // construct the URL to call
        var base_url = 'https://api.spotify.com/v1/search';
        var query_url = base_url + '?' + encodeParameters(parameters);
        console.log(query_url);

        // create an XMLHttpRequest object, add a listener to
        // tell it what to do if successful, tell it which URL
        // to GET, and then make ('send') the call
        var xhttp = new XMLHttpRequest();
        xhttp.addEventListener('load', processResponse);
        xhttp.open('GET', query_url);
        xhttp.send();
    </script>
    <script>
        // Function that will process the response from the API
        var processResponse = function() {
            var data = JSON.parse(this.response);
            // Replace this code with code that
            // does something with the response
            console.log(data);
        }

        // Function to ensure parameters used in request are encoded correctly
        var encodeParameters = function(params) {
            // join all key value pairs and store in an array
            var strArray = [];
            for(var key in params) {
                if(params.hasOwnProperty(key)) {
                    var paramString = encodeURIComponent(key) + "=" + encodeURIComponent(params[key]);
                    strArray.push(paramString);
                }
            }
            // join everything in the array together
            return strArray.join("&");
        }

        // the parameters for the API request
        var parameters = {
            market: "GB",
        }
        var artist_id = "6VsiDFMZJlJ053P1uO4A6h";

        // construct the URL to call
        var base_url = 'https://api.spotify.com/v1/artists/' + artist_id + '/albums';
        var query_url = base_url + '?' + encodeParameters(parameters);
        console.log(query_url);

        // create an XMLHttpRequest object, add a listener to
        // tell it what to do if successful, tell it which URL
        // to GET, and then make ('send') the call
        var xhttp = new XMLHttpRequest();
        xhttp.addEventListener('load', processResponse);
        xhttp.open('GET', query_url);
        xhttp.send();
    </script>
    <script>
         hljs.initHighlightingOnLoad();
    </script>
</html>
